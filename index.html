<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script>
/* global nn*/

let full_text

async function initialize(){
  let txt = await fetch("sonnets.txt")
  full_text = await txt.text()
  write()
}

async function write(){
  nn.create('span')
  .content(await get_word(154, 2, 3))
  .addTo("body")
}

//GET A SONNET
async function get_sonnet(number){
  let to_search = await full_text.toString()
  let first = await to_search.search(number.toString())
  let last = await to_search.toString().search((number + 1).toString())
  return await full_text.toString().slice(first + first.toString().length, last)
}

async function get_line(sonnet, number){
  let to_search = await get_sonnet(sonnet)
  const lines = await to_search.split("\n");
  for (let i = 0; i < lines.length; i ++){
    if (lines[i] === ""){
      lines.splice(i,1)
      //console.log("beep")
    }
  }
  lines.unshift("")
  console.log(lines) 
  return lines[number]
}

async function get_word(sonnet, line, number){
  let to_search = await get_line(sonnet, line)
  const words = await to_search.split(" ")
  for (let i = 0; i < words.length; i ++){
    if (words[i] === ""){
      words.splice(i,1)
      //console.log("beep")
    }
  }
  //console.log(words)
  return words[number]
}

nn.on('load', initialize)

</script>